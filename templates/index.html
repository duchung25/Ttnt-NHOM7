<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>D·ª± b√°o th·ªùi ti·∫øt - Naive Bayes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <h1 class="main-title">‚òÄÔ∏è D·ª± b√°o th·ªùi ti·∫øt b·∫±ng Naive Bayes ‚òî</h1>
    <div class="weather-box">
        <form id="weatherForm" autocomplete="off">
            <div class="form-row">
                <label for="temp">Nhi·ªát ƒë·ªô (¬∞C):</label>
                <input type="number" id="temp" min="0" max="50" required placeholder="V√≠ d·ª•: 30">
            </div>
            <div class="form-row">
                <label for="humidity">ƒê·ªô ·∫©m (%):</label>
                <input type="number" id="humidity" min="0" max="100" required placeholder="V√≠ d·ª•: 70">
            </div>
            <div class="form-row">
                <label for="sunny">Tr·ªùi n·∫Øng?</label>
                <select id="sunny">
                    <option value="1">C√≥</option>
                    <option value="0">Kh√¥ng</option>
                </select>
            </div>
            <div class="form-row">
                <label for="wind">T·ªëc ƒë·ªô gi√≥ (km/h):</label>
                <input type="number" id="wind" min="0" max="100" required placeholder="V√≠ d·ª•: 15">
            </div>
            <button class="btn" type="submit">D·ª± b√°o ngay</button>
        </form>
        <div class="result" id="result"></div>
    </div>
    <footer>
        <span>D·ª± √°n h·ªçc m√°y &copy; 2025 | Nh√≥m 7</span>
    </footer>
</div>
<script>
document.getElementById('weatherForm').onsubmit = async function(e) {
    e.preventDefault();
    const temp = document.getElementById('temp').value;
    const humidity = document.getElementById('humidity').value;
    const sunny = document.getElementById('sunny').value;
    const wind = document.getElementById('wind').value;
    const resultDiv = document.getElementById('result');
    resultDiv.innerHTML = "<div class='loading'>ƒêang d·ª± b√°o...</div>";
    try {
        const res = await fetch('/predict', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                temperature: temp,
                humidity: humidity,
                sunny: sunny,
                wind: wind
            })
        });
        const data = await res.json();
        if(data.error) throw new Error(data.error);
        resultDiv.innerHTML = (
            (data.prediction === 1
                ? "<div class='rainy'>üåßÔ∏è <b>C√≥ th·ªÉ <span>m∆∞a</span></b>!</div>"
                : "<div class='sunny'>‚òÄÔ∏è <b>Kh√¥ng m∆∞a</b>, b·∫°n c√≥ th·ªÉ y√™n t√¢m ra ngo√†i!</div>")
            + `<div class="prob">X√°c su·∫•t m∆∞a: <b>${(data.probability.rain*100).toFixed(1)}%</b> &nbsp;|&nbsp; Kh√¥ng m∆∞a: <b>${(data.probability.no_rain*100).toFixed(1)}%</b></div>`
        );
    } catch(e) {
        resultDiv.innerHTML = `<div class="error">L·ªói: ${e.message}</div>`;
    }
};
</script>
</body>
</html>